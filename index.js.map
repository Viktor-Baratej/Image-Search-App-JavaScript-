{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/main.js","../src/js/render-functions.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nexport let pages = 1;\r\nexport let maxPhoto = 15;\r\n\r\nexport function incrementPage() {\r\n  pages += 1;\r\n}\r\n\r\nexport function resetPage() {\r\n  pages = 1;\r\n}\r\n\r\nexport async function fetchImages(userInput) {\r\n  const keyApi = '46773204-8ec36d0a78d9132ebe706b3ce';\r\n\r\n  const params = new URLSearchParams({\r\n    key: keyApi,\r\n    q: userInput,\r\n    image_type: 'photo',\r\n    orientation: 'horizontal',\r\n    safesearch: true,\r\n    page: pages,\r\n    per_page: maxPhoto,\r\n  });\r\n\r\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\r\n  return response.data;\r\n}\r\n","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nimport {\r\n  fetchImages,\r\n  incrementPage,\r\n  pages,\r\n  resetPage,\r\n} from './js/pixabay-api.js';\r\n\r\nimport {\r\n  renderImages,\r\n  showLoading,\r\n  hideLoading,\r\n} from './js/render-functions.js';\r\n\r\nconst body = document.querySelector('body');\r\nlet lightbox = new SimpleLightbox('.gallery a', {\r\n  captions: true,\r\n  captionsData: 'alt',\r\n  captionDelay: 250,\r\n  loop: true,\r\n});\r\n\r\nconst form = document.querySelector('.form');\r\nconst userInput = document.querySelector('.user-input');\r\nconst btnPages = document.querySelector('.btn-load');\r\n\r\nfunction showBtn() {\r\n  btnPages.classList.remove('hidden');\r\n}\r\n\r\nexport function closeBtn() {\r\n  btnPages.classList.add('hidden');\r\n}\r\n\r\ncloseBtn();\r\n\r\nlet userText;\r\n\r\nform.addEventListener('submit', async event => {\r\n  event.preventDefault();\r\n  userText = userInput.value.trim();\r\n\r\n  if (userText) {\r\n    resetPage();\r\n    showLoading();\r\n    btnPages.removeEventListener('click', loadMoreImages);\r\n\r\n    try {\r\n      const data = await fetchImages(userText);\r\n      if (!renderImages(data, lightbox)) {\r\n        iziToast.error({\r\n          message: 'No images found. Try a different query!',\r\n          position: 'topRight',\r\n        });\r\n        closeBtn();\r\n      } else if (data.totalHits > 15) {\r\n        showBtn();\r\n        btnPages.addEventListener('click', loadMoreImages);\r\n      }\r\n    } catch (error) {\r\n      iziToast.error({\r\n        message: 'An error occurred while fetching images. Please try again.',\r\n        position: 'topRight',\r\n      });\r\n    } finally {\r\n      hideLoading();\r\n    }\r\n  }\r\n});\r\n\r\nasync function loadMoreImages() {\r\n  incrementPage();\r\n  showLoading();\r\n  try {\r\n    const data = await fetchImages(userText);\r\n    if (data.hits.length === 0) {\r\n      iziToast.warning({\r\n        message: 'No more images to load.',\r\n        position: 'topRight',\r\n      });\r\n      closeBtn();\r\n    } else {\r\n      renderImages(data, lightbox);\r\n      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });\r\n    }\r\n  } catch (error) {\r\n    iziToast.error({\r\n      message: 'Failed to load more images. Please try again.',\r\n      position: 'topRight',\r\n    });\r\n  } finally {\r\n    hideLoading();\r\n  }\r\n}\r\n","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nimport { fetchImages, pages, maxPhoto } from './pixabay-api';\r\nimport { closeBtn } from '../main';\r\n\r\nconst div = document.querySelector('.wrapp');\r\nconst list = document.querySelector('.gallery');\r\n\r\nexport function renderImages(data, lightbox) {\r\n  if (data.total === 0) {\r\n    list.innerHTML = '';\r\n    return;\r\n  } else {\r\n    const maxPages = Math.ceil(data.totalHits / maxPhoto);\r\n    if (pages >= maxPages) {\r\n      closeBtn();\r\n      iziToast.error({\r\n        message: \"You've reached the end of search results.\",\r\n        position: 'topRight',\r\n      });\r\n    }\r\n\r\n    const smallImg = data.hits\r\n      .map(\r\n        item => `\r\n          <li class=\"gallery-item\">\r\n            <a href=\"${item.largeImageURL}\" data-source=\"${item.largeImageURL}\">\r\n              <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" />\r\n            </a>\r\n            <div class=\"wrapp-items\">\r\n              <div class=\"info-item\"><p class=\"bold\">Likes</p><p>${item.likes}</p></div>\r\n              <div class=\"info-item\"><p class=\"bold\">Views</p><p>${item.views}</p></div>\r\n              <div class=\"info-item\"><p class=\"bold\">Comments</p><p>${item.comments}</p></div>\r\n              <div class=\"info-item\"><p class=\"bold\">Downloads</p><p>${item.downloads}</p></div>\r\n            </div>\r\n          </li>`\r\n      )\r\n      .join('');\r\n\r\n    list.innerHTML = pages === 1 ? smallImg : list.innerHTML + smallImg;\r\n    lightbox.refresh();\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function showLoading() {\r\n  div.classList.remove('hidden');\r\n}\r\n\r\nexport function hideLoading() {\r\n  div.classList.add('hidden');\r\n}\r\n"],"names":["pages","maxPhoto","incrementPage","resetPage","fetchImages","userInput","keyApi","params","axios","lightbox","SimpleLightbox","form","btnPages","showBtn","closeBtn","userText","event","showLoading","loadMoreImages","data","renderImages","iziToast","hideLoading","div","list","maxPages","smallImg","item"],"mappings":"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"}