{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/main.js","../src/js/render-functions.js"],"sourcesContent":["import axios from 'axios';\n\nexport let pages = 1;\nexport let maxPhoto = 15;\nexport function incrementPage() {\n  pages += 1;\n}\nexport function resetPage() {\n  pages = 1;\n}\nexport async function fetchImages(userInput) {\n  const keyApi = '46773204-8ec36d0a78d9132ebe706b3ce';\n  let url = `https://pixabay.com/api/?key=${keyApi}&q=${userInput}&image_type=photo&orientation=horizontal&safesearch=true&page=${pages}&per_page=3`;\n\n  const params = new URLSearchParams({\n    key: keyApi,\n    q: userInput,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pages,\n    per_page: maxPhoto,\n  });\n\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\n\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  fetchImages,\n  incrementPage,\n  pages,\n  resetPage,\n} from './js/pixabay-api.js';\n\nimport {\n  renderImages,\n  showLoading,\n  hideLoading,\n} from './js/render-functions.js';\n\nconst body = document.querySelector('body');\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  loop: true,\n});\n\nlet width;\n\nconst form = document.querySelector('.form');\nconst userInput = document.querySelector('.user-input');\nconst btnPages = document.querySelector('.btn-load');\n\nfunction showBtn() {\n  btnPages.style.display = 'block';\n  console.log('Button shown');\n}\n\nexport function closeBtn() {\n  btnPages.style.display = 'none';\n  console.log('Button hidden');\n}\n\ncloseBtn();\n\nlet userText;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  if (userInput.value.trim()) {\n    userText = userInput.value.trim();\n    resetPage();\n    btnPages.removeEventListener('click', loadMoreImages);\n  } else {\n    userText = undefined;\n  }\n\n  if (userText) {\n    showLoading();\n    try {\n      const data = await fetchImages(userText);\n      if (!renderImages(data, lightbox)) {\n        throw new Error('No images found!');\n      } else {\n        showBtn();\n\n        btnPages.addEventListener('click', loadMoreImages);\n      }\n    } catch (error) {\n      closeBtn();\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n    } finally {\n      hideLoading();\n    }\n  }\n});\n\nasync function loadMoreImages() {\n  incrementPage();\n  console.log('Current page:', pages);\n  try {\n    showLoading();\n    const data = await fetchImages(userText);\n    if (data.hits.length === 0) {\n      closeBtn();\n      iziToast.warning({\n        message: 'No more images to load.',\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n      return;\n    }\n    renderImages(data, lightbox);\n\n    setTimeout(() => {\n      window.scrollTo({\n        top: document.body.scrollHeight,\n        behavior: 'smooth',\n      });\n    }, 300);\n    update();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction update() {\n  const elem = document.querySelector('.gallery');\n  const rect = elem.getBoundingClientRect();\n  if (rect.height) {\n    width = rect.height;\n  }\n}\n\ndocument.addEventListener('scroll', update);\nupdate();\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages, pages, maxPhoto } from './pixabay-api';\nimport { closeBtn } from '../main';\n\nconst div = document.querySelector('.wrapp');\n\nconst list = document.querySelector('.gallery');\n\nexport function renderImages(data, lightbox) {\n  if (data.total === 0) {\n    list.innerHTML = '';\n    return undefined;\n  } else {\n    let max = Math.ceil(data.totalHits / maxPhoto);\n    console.log(max);\n    if (max === pages) {\n      closeBtn();\n\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n    }\n    hideLoading();\n    const smallImg = data.hits\n      .map(\n        item =>\n          `<li class=\"gallery-item\"><a href=\"${item.largeImageURL}\" data-source=\"${item.largeImageURL}\"><img src=\"${item.webformatURL}\" alt=\"${item.tags}\" /></a>\n          <div class=\"wrapp-items\">\n          <div class=\"info-item\"><p class=\"bold\">Likes</p>\n          <p>${item.likes}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Views</p>\n          <p>${item.views}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Comments</p>\n          <p>${item.comments}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Downloads</p>\n          <p>${item.downloads}</p>\n          </div>\n\n          </div></li>`\n      )\n      .join('');\n\n    if (pages !== 1) {\n      list.insertAdjacentHTML('beforeend', smallImg);\n    } else {\n      list.innerHTML = smallImg;\n    }\n\n    lightbox.refresh();\n    return true;\n  }\n}\n\nexport function showLoading() {\n  div.style.display = 'block';\n}\n\nexport function hideLoading() {\n  div.style.display = 'none';\n}\n"],"names":["pages","maxPhoto","incrementPage","resetPage","fetchImages","userInput","keyApi","params","axios","lightbox","SimpleLightbox","form","btnPages","showBtn","closeBtn","userText","event","loadMoreImages","showLoading","data","renderImages","iziToast","hideLoading","update","error","rect","div","list","max","smallImg","item"],"mappings":"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"}